@page "/admin"
@inject HttpClient HttpClient
@inject QuestState QuestState
@implements IDisposable

<div class="left-nav">
    <ul>
        <li>
            <a class="active working">Manage Quests</a>
        </li>
    </ul>
</div>
<div class="content">
    <h1>Manage Quests</h1>
    <AdminQuestList></AdminQuestList>
    @if (QuestState.CurrentQuest != null)
    {
        <hr />
        <AdminQuestEdit></AdminQuestEdit>
        <AdminTaskList></AdminTaskList>        
        if (QuestState.CurrentTask != null)
        {
            <hr />
            <AdminTaskEdit></AdminTaskEdit>
        }
    }
</div>

@functions {
    protected override void OnInit()
    {        
        QuestState.OnStateChanged += OnStateChanged;
    }

    void IDisposable.Dispose()
    {
        QuestState.OnStateChanged -= OnStateChanged;
    }

    void OnStateChanged(object sender, EventArgs e) => StateHasChanged();
}